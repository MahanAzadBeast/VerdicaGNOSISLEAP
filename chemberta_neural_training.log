✅ ChemBERTa (transformers) available - will use pretrained model
🧬 CHEMBERTA NEURAL NETWORK TRAINING ON GDSC/DEPMAP DATA
==========================================================================================
🎯 NEURAL NETWORK TRAINING (NOT SIMULATION)
🤖 ChemBERTa Available: True

📊 STEP 1: Creating GDSC/DepMap training dataset...
📊 Creating comprehensive GDSC/DepMap-inspired training dataset...
   ✅ GDSC/DepMap-inspired dataset created: 600 records
   📊 Unique cell lines: 60
   📊 Unique drugs: 10
   📊 IC50 range: 7.65 - 49634.95 nM
   📊 Cancer types: 7

🔧 STEP 2: Preparing molecular and genomic features...
   🧬 Using ChemBERTa for molecular encoding
   📊 Molecular features: 600 SMILES
   📊 Genomic features: (600, 39)
   📊 Targets: (600,)
   📊 pIC50 range: 4.30 - 8.12

📋 STEP 3: Creating stratified train/test split...
   📊 Training cell lines: 11
   📊 Test cell lines: 4
   📊 Training samples: 440
   📊 Test samples: 160

🗂️ STEP 4: Creating PyTorch datasets...

🤖 STEP 5: Initializing ChemBERTa Cell Line Model...
🧬 Initializing ChemBERTa drug encoder...
✅ ChemBERTa encoder initialized (hidden_size: 768)
   🖥️ Device: cpu
   📊 Total parameters: 45,207,106
   📊 Trainable parameters: 45,207,106
❌ ChemBERTa neural network training failed: The size of tensor a (767) must match the size of tensor b (514) at non-singleton dimension 0
Traceback (most recent call last):
  File "/app/train_chemberta_neural_network.py", line 688, in train_chemberta_neural_network
    other_params = [p for p in model.parameters() if p not in chemberta_params]
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/app/train_chemberta_neural_network.py", line 688, in <listcomp>
    other_params = [p for p in model.parameters() if p not in chemberta_params]
                                                     ^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: The size of tensor a (767) must match the size of tensor b (514) at non-singleton dimension 0

Training result: {'status': 'failed', 'error': 'The size of tensor a (767) must match the size of tensor b (514) at non-singleton dimension 0'}
